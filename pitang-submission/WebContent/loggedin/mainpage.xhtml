<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">

<h:head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

	<title>User Panel</title>
</h:head>


<h:body style="">
	<p:layout fullPage="true">
		<p:layoutUnit position="north">
			<p:outputLabel value="Welcome, #{loginCDI.user.name}" style="" />
		</p:layoutUnit>
		<p:layoutUnit id="leftLayout" position="west" size="300" resizable="true">
			<p:outputLabel value="Email:" />
			<p:inputText id="registerEmail" required="true"
				value="#{userCDI.user.email}" 
				placeholder="Email" ></p:inputText>
		</p:layoutUnit>
		
		<p:layoutUnit position="center" size="500">
			<h:form >
				<p:dataTable id="usersTable" value="#{userCDI.userList}" var="user"
					type="definition" selectionMode="single" rowKey="#{user.email}"
					selection="#{userCDI.user}" >
					
					<p:ajax event="rowSelect" update=":leftLayout" listener="#{mainPageBean.someListener}" />
					
					<p:column headerText="Name">#{user.name}</p:column>
					<p:column headerText="Email">#{user.email}</p:column>
					<p:column headerText="Phones">
						<p:repeat var="phone" value="#{user.phones}">
							(#{phone.regionCode})
						</p:repeat>
					</p:column>


				</p:dataTable>
				<div style="width: 100%; display: inline-flex;">
					<p:commandButton value="Edit" action="#{userCDI.editUser}"
						update="leftLayout" style="height:5%;width:100%;" />
					<p:commandButton value="Remove" action="#{userCDI.removeUser}"
						update="usersTable" style="height:5%;width:100%;" />
				</div>
			</h:form>
		</p:layoutUnit>
	</p:layout>


</h:body>
</html>